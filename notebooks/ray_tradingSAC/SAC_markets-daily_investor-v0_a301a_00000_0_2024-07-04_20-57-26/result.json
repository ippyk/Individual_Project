{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 1505, "timesteps_this_iter": 0, "agent_timesteps_total": 1505, "timers": {"load_time_ms": 0.174, "load_throughput": 1470879.211, "learn_time_ms": 31.099, "learn_throughput": 8231.691, "update_time_ms": 2.28}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": -1.0999008417129517, "critic_loss": 20.288583755493164, "alpha_loss": 0.0, "alpha_value": [1.0], "log_alpha_value": [-0.00029999855905771255], "target_entropy": [1.076640009880066], "policy_t": 0.3333333134651184, "mean_q": 0.0012854930246248841, "max_q": 0.018996773287653923, "min_q": -0.020894186571240425}, "td_error": "[2.53632689e+00 2.66657782e+00 6.66161239e-01 1.91622696e+01\n 2.19183388e+01 3.28544235e+00 2.53632689e+00 1.94132919e+01\n 7.91784477e+00 2.41812086e+00 4.64163818e+01 1.22853222e+01\n 4.32860031e+01 1.21652756e+01 1.21698608e+01 2.91624832e+01\n 3.35378342e+01 1.87892685e+01 5.26627579e+01 2.91728592e+00\n 4.08001709e+01 2.17889214e+01 3.27906647e+01 1.41701012e+01\n 1.79229653e+00 2.44133797e+01 1.09148769e+01 6.32327437e-01\n 7.90648746e+00 2.19183388e+01 1.84187698e+01 2.79120407e+01\n 9.19452727e-01 9.54459763e+00 7.19197693e+01 1.29168344e+00\n 3.35452080e+01 2.44131870e+01 1.10422001e+01 1.08168328e+00\n 8.28931999e+00 2.25437279e+01 3.31659050e+01 5.14188995e+01\n 6.15908241e+00 3.65463409e+01 5.28723049e+00 1.66639447e+00\n 1.52902012e+01 2.47887249e+01 4.08001709e+01 5.66281891e+00\n 5.87125540e-01 2.42861042e+01 5.50497818e+01 5.72956314e+01\n 1.87896004e+01 1.52866344e+01 2.67889481e+01 5.72956314e+01\n 5.14911115e-01 1.58016548e+01 3.79448938e+00 2.60418034e+01\n 1.39124317e+01 3.90425339e+01 1.41701012e+01 2.34162064e+01\n 5.28723049e+00 1.53828931e+00 1.82905769e+01 3.10396194e+01\n 2.04147358e+01 2.26691570e+01 2.35440655e+01 4.60116565e-02\n 4.32860031e+01 1.08773220e+00 1.08267617e+00 5.26627579e+01\n 5.14231834e+01 9.29058838e+00 1.95407600e+01 7.91410637e+00\n 1.04142103e+01 4.78872919e+00 6.66886425e+00 6.42730141e+00\n 1.91286933e+00 1.08267617e+00 9.99150391e+01 7.92045498e+00\n 2.22878571e+01 2.05497116e-01 9.41614914e+00 3.29066014e+00\n 1.16592245e+01 1.70403118e+01 1.53962469e+00 1.44165173e+01\n 3.15444489e+01 2.94180641e+01 3.20390129e+01 1.26637688e+01\n 1.34204063e+01 2.12328166e-01 3.70369339e+01 3.56640854e+01\n 3.99141998e+01 1.09537178e+02 1.41631575e+01 4.82872505e+01\n 1.52915344e+01 9.61731017e-01 2.29149437e+01 3.53593731e+00\n 3.70401230e+01 2.95387993e+01 2.49076424e+01 4.26671371e+01\n 7.66765118e+00 2.12868919e+01 6.66161239e-01 2.51676483e+01\n 1.77909737e+01 3.00396156e+01 9.42333794e+00 5.42834699e-01\n 4.17073131e-01 1.86686020e+01 4.84165573e+01 3.24165688e+01\n 4.66018438e+00 3.54149318e+00 5.40697193e+00 7.53802824e+00\n 2.86629181e+01 1.71615410e+01 2.64146652e+01 1.84151192e+01\n 3.02869549e+01 2.51676483e+01 3.06627254e+01 1.49188919e+01\n 4.37880363e+01 7.79314518e+00 3.11670876e+01 7.66667252e+01\n 1.49080429e+01 2.57913246e+01 7.88220525e-01 2.80337524e+01\n 5.14911115e-01 1.42885361e+01 8.05410309e+01 9.91792774e+00\n 2.52867928e+01 3.25294495e+01 5.39743721e-01 1.89114113e+01\n 1.95407600e+01 3.65463409e+01 2.25413132e+01 1.76700897e+01\n 4.57946281e+01 2.39218750e+01 2.89190063e+01 1.24181576e+01\n 6.54595184e+00 1.75413475e+01 8.01275223e-02 5.41538656e-01\n 2.41658401e+00 4.24167404e+01 2.29149437e+01 2.97944489e+01\n 2.17964115e+01 6.91903114e+00 1.54444909e+00 2.15405464e+01\n 5.14231834e+01 5.14911115e-01 2.81642036e+01 4.19150543e+01\n 1.89114113e+01 1.92935944e+01 1.97896748e+01 5.42748570e-01\n 3.26574707e+01 5.54044676e+00 9.66297340e+00 1.68948978e-01\n 1.21672688e+01 2.01656456e+01 8.58008564e-02 1.04140472e+01\n 2.50397377e+01 4.82921791e+01 9.67843628e+00 7.91392088e+00\n 3.91885233e+00 1.95382309e+01 9.28653908e+00 2.52888794e+01\n 7.91774845e+00 1.54175749e+01 2.26652756e+01 6.62952499e+01\n 4.14189072e+01 1.10627527e+01 1.97869987e+01 9.54459763e+00\n 1.44110804e+01 2.29088163e+00 3.21653328e+01 2.51726570e+01\n 3.26639252e+01 5.82276821e-01 2.74152222e+01 3.41636887e+01\n 3.27966156e+01 1.17254496e+00 1.02890778e+01 1.97898102e+01\n 7.29083872e+00 3.61633263e+01 1.04132261e+01 2.00386868e+01\n 2.57959118e+01 1.32896624e+01 2.24177589e+01 2.16621056e+01\n 1.08680916e+00 7.41564178e+00 5.40778637e+00 4.11680832e+01\n 5.39164810e+01 1.04140472e+01 4.09135513e+01 8.29279327e+00\n 2.15448685e+01 6.39193954e+01 2.65376511e+01 8.79304123e+00\n 2.16616225e+00 8.54093933e+00 5.50497818e+01 1.92892570e+01\n 2.57959118e+01 4.72930450e+01 2.84655243e-01 1.76654434e+01\n 3.87903824e+01 5.35435867e+01 4.35502663e+01 1.82905769e+01]", "mean_td_error": 20.773569107055664, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1505, "num_agent_steps_sampled": 1505, "num_steps_trained": 256, "num_agent_steps_trained": 256, "last_target_update_ts": 1505, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-02-12", "timestamp": 1720123332, "time_this_iter_s": 273.9540786743164, "time_total_s": 273.9540786743164, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7bc9c220>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7bc9c160>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7bc9c0a0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7bc9cfd0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 273.9540786743164, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 14.994884910485933, "ram_util_percent": 10.614833759590791}}
{"episode_reward_max": -6117.030952380952, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -7291.728231292517, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047], "episode_lengths": [301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0562311165654417, "mean_inference_ms": 1.9006041288850226, "mean_action_processing_ms": 0.07454076707007351, "mean_env_wait_ms": 946.700036739193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 2506, "timesteps_this_iter": 0, "agent_timesteps_total": 2506, "timers": {"load_time_ms": 0.176, "load_throughput": 1452572.814, "learn_time_ms": 24.62, "learn_throughput": 10398.067, "update_time_ms": 2.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 21.522159576416016, "critic_loss": 11.720954895019531, "alpha_loss": -0.0021763623226433992, "alpha_value": [1.006718635559082], "log_alpha_value": [0.007219249382615089], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -23.102798461914062, "max_q": -1.6470060348510742, "min_q": -50.777442932128906}, "td_error": "[ 2.7440186   6.107383    2.148553    6.9571905   2.5330439  11.047967\n  0.96517944 21.104553   19.677948    2.9612179  11.978922   15.5724125\n 10.880085   17.97905     1.1747732   2.8533812  14.003759   12.377842\n 47.27521    99.03664     9.368232    6.4756536  12.862616    3.4728289\n 14.687509   10.29941     3.4394207  28.548075   14.855835    4.031293\n  4.247141    5.2705956   0.55379486  1.9411354  15.310135    4.9813404\n 29.802376   11.753934    5.152361    0.90020275  7.1950817   7.3860693\n  3.8635054  36.376286   13.563863   21.960608   13.036551   24.38806\n 25.152143   15.224434   16.867123    5.900852    4.085809    9.515872\n  1.4066845   3.7883716   4.9281945  11.750387    9.797884   28.378536\n 12.714786    1.7691755  22.458284   10.568608   20.487349    1.4393959\n 14.025111   16.521633   21.267921   10.208923    6.651912    3.6790476\n  0.5532503  11.649855   14.634714   40.822643    5.798665    0.7436962\n  8.0795145   7.515274    5.5892057  16.090944   20.800903   14.003759\n  1.0799441   2.5205765  14.166967   24.132156   23.721298   11.543763\n 14.311225   18.07473    16.733206   14.077839    6.561747   15.978962\n 11.308282   51.715492   16.43435     2.7164583   2.965125   10.303568\n 22.62482    13.527483   20.91135    10.866003   16.417305   19.71501\n 19.217789    5.0664377  18.211145   15.934386   20.981373    5.7958927\n  5.6120815   0.11113262  8.060196    0.41339684 15.992209    0.9856529\n  1.5392551   5.739252   44.3039      0.90020275 30.836922   25.44206\n  0.37373924 11.251984    6.0963726   5.21184    11.307718   16.625896\n  2.6702642   4.916404   15.7206135  12.963802   11.85905     2.8271651\n 36.8717     27.374256   18.87996     4.3474894  14.702096    2.7969074\n  3.173338    7.8184934  24.710754    4.4715676  29.297958    5.6641016\n  7.027916   12.504095    0.42976475 15.041022    1.2559757   3.5431576\n  0.8164544  14.892789   14.425291    6.561747    0.6822834   6.1104603\n 18.060558   10.550267   10.704612    8.989582    5.4821844   4.9667935\n 10.358757    7.5576153   4.5662804  30.44944    12.963802    7.9262633\n  5.7509365   7.1267157   2.116269    8.065933    2.4249496  17.43516\n  2.3955126  33.628822   42.32613     2.0192919   2.9202495  13.153708\n  4.697345   13.2751875  16.381664    1.972031   10.994367    0.95778465\n  3.8376217   6.2522116   1.9216146  59.229813    5.1994476  31.283642\n  1.2037573  21.979744   10.56754    22.123497    8.907265   19.13891\n 12.062057   30.44944    33.687233    3.5048447   5.939186    0.60554695\n  1.5326118   5.6431627  59.229813   10.1805105   7.3625164  16.406437\n  6.3763094   8.280998   47.27521    14.076425    7.9395967   9.125515\n  9.201015    4.997809   10.744804    4.265314    5.117486   19.30194\n  3.435295   26.554043    2.0901642   3.435295    1.5861092   0.93790245\n 23.868216    7.7546167   9.42294     6.9057555   3.5301762  21.046562\n  2.7440186   4.247141    2.0759296   2.5234365  25.461716    0.6958046\n 14.611812   10.704612    8.816536    3.6113281   4.761995   17.129175\n 20.95005     0.17228508 16.625896   31.02153   ]", "mean_td_error": 12.205619812011719, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2506, "num_agent_steps_sampled": 2506, "num_steps_trained": 36864, "num_agent_steps_trained": 36864, "last_target_update_ts": 2506, "num_target_updates": 144, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7, "training_iteration": 2, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-05-43", "timestamp": 1720123543, "time_this_iter_s": 211.59213185310364, "time_total_s": 485.54621052742004, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9f9d00>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9f9d60>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9f9d90>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9f9df0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 485.54621052742004, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.722185430463577, "ram_util_percent": 11.532450331125828}}
{"episode_reward_max": -6117.030952380952, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -7291.728231292517, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047], "episode_lengths": [301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0562311165654417, "mean_inference_ms": 1.9006041288850226, "mean_action_processing_ms": 0.07454076707007351, "mean_env_wait_ms": 946.700036739193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 3507, "timesteps_this_iter": 0, "agent_timesteps_total": 3507, "timers": {"load_time_ms": 0.179, "load_throughput": 1430320.799, "learn_time_ms": 24.859, "learn_throughput": 10298.17, "update_time_ms": 2.033}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 27.133108139038086, "critic_loss": 11.689375877380371, "alpha_loss": -0.059914879500865936, "alpha_value": [1.0875537395477295], "log_alpha_value": [0.08447252959012985], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -32.206298828125, "max_q": -12.165576934814453, "min_q": -108.9753646850586}, "td_error": "[  7.2396107    4.6712666    3.2791471   26.867489    14.433388\n  13.145772     4.7446833   27.396994     5.825835     2.9332676\n  20.424637     5.274354     5.1649513    3.6833076    6.620552\n   8.2058735   14.63456      9.615639     3.957199     0.66846085\n   6.908325    10.230317     5.9175816    6.4861403    8.522871\n   9.760582    11.922039     8.468998    14.413069     5.1052456\n  13.836605     9.338745     7.645567     5.2519255    2.207384\n  46.185802     0.41116142   3.5933352    6.8216887   17.847343\n  15.231817    11.397621   278.13403      0.96934605   9.914969\n  30.628117     1.0698748    1.9952393   10.554695    11.158504\n   1.4322271    1.6994781   16.788816     9.230135     0.3556671\n   4.539029     8.84761     26.202559     2.2115726    6.4193983\n   9.886404     5.296562     4.3818245   11.313961     8.531046\n  14.516888    10.066484     6.2779655   25.734781     0.93606186\n  10.552871    14.450645     5.4160743    1.4019079    4.163417\n   7.8465004   22.22024      8.259771     4.610977    14.574482\n   0.65997314   1.2930336   12.286402    24.663311     4.0641174\n   3.0216656    4.833885     9.832304    15.370598    19.617218\n   1.4019079    2.9294176    8.130949    13.680067     2.9508286\n   5.16671      5.888735     5.4160743   11.952276    21.570576\n   3.2791471    2.9720688    4.6591015    6.986847     2.630588\n 168.20184     14.073353     1.7552032   11.331607    11.079808\n   5.486146    22.671108     2.355054     9.912055    15.248873\n   9.953009     6.979738     2.010522     6.9962997    4.6608934\n   9.063671     2.5116358    8.150555    18.928036    38.357933\n  18.506538     7.838587    18.206139     8.506334    13.37605\n  14.608927     8.22535      2.6085472   12.411651     2.786415\n   4.605131    21.044472     1.6006622    7.648999    13.670477\n  15.171651     6.541272    16.436558     4.5794525    6.0796003\n  10.365629    13.373587    12.177513     9.887808    22.27186\n  31.078325    24.28484     18.684855     5.9676266   13.144369\n   1.9503422    7.5061073   13.167245     5.8644724    1.0135841\n   9.000771     6.235979     4.942623     2.7180567    7.3505545\n   7.7382708   46.185802     7.041239     7.845606     6.3999367\n   2.9748726    5.98273     13.74019      7.250993     6.7941647\n   4.7991476   12.705214     7.8263435   11.320181     8.158527\n  18.836315     8.259771    11.809926    20.197815     3.511135\n  13.687645     5.2217474   11.549458   278.13403      3.5523129\n   9.914969    16.724045     3.059246     8.090956     5.25366\n   2.0240307   14.410159     1.1265497    0.31035995   9.30599\n  11.198181    25.279701     4.187649    19.953033     6.8740273\n   1.0135841   10.608472    13.775925     0.66778755   5.1686954\n   5.087858     4.402519     6.9962997   12.565969    21.700495\n  13.74019      9.899671     9.733479     9.756145     1.3006611\n  10.7039       5.2217474   15.186764     2.277299     6.322714\n   4.892558     7.9760027    0.44246006  11.347111    14.507475\n  10.200439     5.1451244    1.165019     4.980999     5.4468346\n   4.506727    12.525198    39.3647       6.937744    13.194048\n  10.063068    17.372787    16.527853     6.118573     4.3568926\n   0.6995182    0.96062756  22.069248    10.349204     4.59303\n   1.7954597    6.971178     0.6785593    2.7598267   13.784046\n   1.9586172 ]", "mean_td_error": 12.181102752685547, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3507, "num_agent_steps_sampled": 3507, "num_steps_trained": 73472, "num_agent_steps_trained": 73472, "last_target_update_ts": 3507, "num_target_updates": 287, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7, "training_iteration": 3, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-08-49", "timestamp": 1720123729, "time_this_iter_s": 185.41919016838074, "time_total_s": 670.9654006958008, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7bcf6220>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7bc4a1c0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7bc4ab50>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7bc4a130>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 670.9654006958008, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.72301886792453, "ram_util_percent": 11.416226415094343}}
{"episode_reward_max": -4499.5, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -6260.756972789116, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0716916742003786, "mean_inference_ms": 1.9018320922016787, "mean_action_processing_ms": 0.07943049797967226, "mean_env_wait_ms": 951.2377729260772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 4508, "timesteps_this_iter": 0, "agent_timesteps_total": 4508, "timers": {"load_time_ms": 0.176, "load_throughput": 1457502.137, "learn_time_ms": 24.651, "learn_throughput": 10384.993, "update_time_ms": 2.05}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 30.18893814086914, "critic_loss": 9.633289337158203, "alpha_loss": -0.12106959521770477, "alpha_value": [1.1648354530334473], "log_alpha_value": [0.152994304895401], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -37.43791961669922, "max_q": -8.587841033935547, "min_q": -110.97337341308594}, "td_error": "[  2.5509715    1.1910753   12.117501     3.9405422    0.6810398\n   4.470211     2.6484509   14.036192    12.996616    22.84631\n   6.286421     5.7057858   20.378904     3.5810146    1.8945837\n   0.69437313  14.259712     1.703682     1.5539169   12.132506\n   2.157364     6.7095737    3.013341    13.636278    10.430925\n   5.390503     4.5170193   12.116287     0.675766     1.7037935\n  24.563652     2.6052027    9.565844    11.300278     0.9864712\n   4.1534977    2.072237     1.0366211   31.000278    24.534513\n  14.772093     9.951199     3.511116     0.4472065    1.3929901\n   3.7315083   14.21731      2.3170948    7.938305    16.054398\n  18.658918     5.5123463    6.342849    17.56723      7.210102\n   3.592763     5.9591446   13.251493     7.286298    13.965896\n   6.9279137    6.7095737    2.9105625    5.0710964    0.34912872\n   9.018009     0.44960594   9.63472      1.4180698   11.342155\n   1.5892782   10.9088335    3.4739494    0.54149437   0.6380701\n   4.8547983   10.672123    15.766489     8.902884     1.1226406\n   1.3849611    2.4896393    3.7914996    2.8185968    4.0312204\n   7.4582024    8.020665     2.519144     1.8595657   11.08086\n   2.8918934    0.9725151    4.487587     5.8104057   81.407455\n  11.111521     1.3910923    9.204857    24.408024     8.220629\n   1.6714058    9.8030815    5.8339825    9.317061     1.9578867\n   3.9878807    7.780836     6.704115    19.385406    11.145985\n   8.359108    11.572369     5.542734     0.9847746    2.0995235\n   0.23743439   4.436715    20.66505      9.099697     9.5744915\n   5.919018     0.5864048    7.3989077    8.3957405    3.4214315\n   6.5240498    1.292736    11.5672035  192.9122       8.646374\n   4.012083     3.4268036    2.100254    12.179886     8.599672\n   2.2877007    1.080493     8.07651      0.71808624   3.319765\n   1.7358093   10.106886    11.565935     1.7358093    6.3820763\n   8.974958     2.2976875    1.3654165   17.636759     3.6915417\n   6.1736565    7.6192913    6.5237207   16.34871      6.7242384\n   9.686687     6.0695505    4.490288     7.097787     3.63842\n  13.719982    28.491123     6.1482487    5.661483     9.579425\n   9.565844    29.261925     9.316334    12.327013     2.9336033\n   7.693592    15.156059    16.27422      0.32987976  19.411388\n  20.369263     7.2154446   14.929222     7.8294163    5.378395\n  24.717306     3.3047504    3.6443062   42.685753    18.074461\n   0.83432484  26.43298      3.7014465    7.2000923    6.2478046\n  17.831736    10.069927     2.4817638    6.9274025    5.7458525\n  17.835854     0.68120766   2.8432827    5.13463      2.7972164\n  12.337535    10.614819     0.74999046   6.6911497    8.842795\n   3.494193     3.899931     2.3982353   18.568043     6.1859646\n   1.852747     1.292736    63.895348     1.1225147    5.428053\n   7.747445     0.6936836    1.7990761   17.142473     9.190247\n   9.798833    90.97002      9.168781     8.53978     10.478016\n   2.4573398    8.646374    11.668114     4.570483     2.120944\n   4.551717     1.4633036   10.94527      8.841797     3.6182747\n   8.496435    12.888644     4.871557     7.4529495    2.7823124\n 206.717        5.3765736   11.702423    14.621044     3.4791403\n   6.9876575    9.225616     9.22995     13.384163     6.355711\n  12.960333    24.65459     10.111052     5.0566034    2.8672638\n   6.036646  ]", "mean_td_error": 10.115229606628418, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4508, "num_agent_steps_sampled": 4508, "num_steps_trained": 110080, "num_agent_steps_trained": 110080, "last_target_update_ts": 4508, "num_target_updates": 430, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14, "training_iteration": 4, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-12-24", "timestamp": 1720123944, "time_this_iter_s": 215.53954362869263, "time_total_s": 886.5049443244934, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9d6dc0>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9d6d60>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9d6850>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9d6d90>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 886.5049443244934, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.61400651465798, "ram_util_percent": 11.701628664495113}}
{"episode_reward_max": -4499.5, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -6260.756972789116, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0716916742003786, "mean_inference_ms": 1.9018320922016787, "mean_action_processing_ms": 0.07943049797967226, "mean_env_wait_ms": 951.2377729260772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 5509, "timesteps_this_iter": 0, "agent_timesteps_total": 5509, "timers": {"load_time_ms": 0.174, "load_throughput": 1473301.076, "learn_time_ms": 25.282, "learn_throughput": 10125.714, "update_time_ms": 2.108}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 37.517093658447266, "critic_loss": 10.79963493347168, "alpha_loss": -0.16928432881832123, "alpha_value": [1.2319992780685425], "log_alpha_value": [0.20901772379875183], "target_entropy": [1.076640009880066], "policy_t": 0.3333333134651184, "mean_q": -44.51956558227539, "max_q": -16.059560775756836, "min_q": -149.19906616210938}, "td_error": "[2.66183434e+01 6.40579796e+00 5.11398125e+00 4.50177193e+00\n 1.78223801e+00 5.44693947e+00 2.37761402e+00 1.39233017e+00\n 2.12636948e+00 6.64184761e+00 3.08749580e+01 5.63737106e+00\n 2.32862568e+00 3.67416668e+00 9.80918884e-01 6.44980240e+00\n 3.91378593e+00 1.12094564e+01 8.50368881e+00 1.72759056e+01\n 2.36303520e+00 8.05244446e-01 1.28596573e+01 1.02052517e+01\n 8.53530884e+00 1.02550125e+01 1.25546074e+00 1.91768131e+01\n 1.00721092e+01 1.29851112e+01 9.90734673e+00 1.59817944e+01\n 9.08946228e+00 5.44549561e+00 5.04111290e-01 5.66775131e+00\n 1.65654755e+00 5.86046314e+00 2.45375061e+00 5.17584419e+00\n 1.16065693e+01 1.27261848e+01 5.09819031e-01 5.54619980e+00\n 1.42408838e+01 1.66770267e+01 1.87154865e+00 6.38768387e+00\n 1.54942131e+00 3.89534950e+00 9.57174492e+00 2.60139160e+01\n 1.12070465e+01 1.09455605e+01 4.25103664e+00 3.62608910e-01\n 3.23771191e+00 3.95159149e+00 1.47537937e+01 3.13786736e+01\n 3.60474396e+00 1.00221405e+01 5.35482407e+00 8.18260574e+00\n 1.11137791e+01 5.92943001e+00 1.60294571e+01 7.41791153e+00\n 5.43922729e+01 3.42838478e+00 7.25268364e+00 8.78547668e+00\n 5.34894943e+00 9.76897621e+00 4.63766956e+00 9.28947544e+00\n 9.16833878e+00 3.26344681e+00 7.07871437e+00 5.44845104e+00\n 8.17622566e+00 5.01280594e+00 4.94162178e+00 5.12102699e+00\n 7.69818497e+00 2.64307175e+01 2.96429062e+00 8.64168358e+00\n 5.77283669e+00 1.20052910e+01 2.82621384e+00 4.71784019e+00\n 7.62281990e+00 8.27280426e+00 2.04901276e+01 8.03153324e+00\n 1.79599953e+00 5.79712486e+00 1.51127644e+01 6.66015625e+00\n 4.63803482e+00 2.24662781e+00 1.54005814e+00 3.58913460e+01\n 8.42576981e-01 1.74686718e+01 9.93896484e-01 9.38043976e+00\n 1.06862946e+01 1.67677879e+00 7.58371925e+00 1.36146774e+01\n 7.27660370e+00 9.73304939e+00 6.32797432e+00 2.13020592e+01\n 1.87344933e+00 3.57335968e+01 3.60474396e+00 1.51337433e+00\n 1.58364334e+01 5.82435608e+00 1.70660248e+01 1.41495571e+01\n 7.10977936e+00 3.60042763e+00 1.46349974e+01 5.08587074e+00\n 4.40339184e+00 2.23555183e+00 1.02169037e+01 4.58268452e+00\n 2.17301006e+01 1.51459293e+01 7.10135174e+00 1.25510788e+00\n 7.45246887e-01 1.59263649e+01 4.51716805e+00 1.03451176e+01\n 5.02285004e+00 1.40818691e+01 1.63226452e+01 9.60546684e+00\n 2.48242569e+00 7.81448364e+00 3.25360107e+00 8.59162521e+00\n 4.93481064e+00 1.64836693e+01 7.15905952e+00 3.85589600e-01\n 5.94753456e+00 8.28828812e+00 5.54619980e+00 8.96106720e-01\n 6.13986111e+00 1.81480217e+00 1.45562096e+01 1.76991386e+01\n 3.45179749e+00 1.38222637e+01 4.88213730e+00 3.05689621e+00\n 5.11404991e+00 9.99801064e+00 4.35780334e+00 8.96064949e+00\n 3.00024414e+00 3.65441895e+00 2.49326035e+02 1.72423286e+01\n 2.07445450e+01 4.11926365e+00 1.07563210e+00 1.15021954e+01\n 4.68307686e+00 9.87149715e+00 9.85255814e+00 5.79796600e+00\n 1.66331757e+02 3.53600883e+00 1.56741276e+01 1.56120167e+01\n 5.35333347e+00 1.05040970e+01 6.91756821e+00 1.35172615e+01\n 1.02519245e+01 3.88945389e+00 1.06090965e+01 7.13229370e+00\n 1.00191193e+01 2.47905731e-01 5.28742599e+00 6.06788540e+00\n 2.05496521e+01 3.84908104e+00 5.20896339e+00 9.68972015e+00\n 7.77607155e+00 6.95844650e+00 2.21566143e+01 1.42733097e+01\n 1.21347961e+01 2.10172443e+01 1.38971977e+01 2.54399681e+00\n 5.09791374e+00 6.92992973e+00 2.72959137e+00 6.62088490e+00\n 1.88776817e+01 4.18468094e+00 1.27344284e+01 9.63182640e+00\n 2.82737503e+01 1.58364334e+01 2.11328697e+00 4.83501244e+00\n 1.13502064e+01 1.08082199e+00 2.71089355e+02 2.15009785e+00\n 8.64795685e+00 1.13864059e+01 6.84457588e+00 8.47763443e+00\n 1.61707001e+01 7.26551437e+00 2.51593781e+00 4.64090157e+00\n 4.47475243e+00 7.02104568e+00 8.27248383e+00 6.64019775e+00\n 2.18689728e+00 2.25297070e+00 5.75198078e+00 8.64168358e+00\n 4.24630928e+00 2.41590500e-01 1.05434246e+01 2.15498905e+01\n 1.22097263e+01 4.74427986e+00 1.00555058e+01 1.47358665e+01\n 1.04823666e+01 2.22439480e+00 1.35145378e+01 5.21648788e+00\n 5.86671829e-01 4.36439362e+01 1.70414066e+00 3.80963707e+00]", "mean_td_error": 11.289173126220703, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5509, "num_agent_steps_sampled": 5509, "num_steps_trained": 146688, "num_agent_steps_trained": 146688, "last_target_update_ts": 5509, "num_target_updates": 573, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14, "training_iteration": 5, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-15-38", "timestamp": 1720124138, "time_this_iter_s": 193.4993119239807, "time_total_s": 1080.0042562484741, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9e27f0>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9e2850>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9e2880>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9e28e0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 1080.0042562484741, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.853429602888085, "ram_util_percent": 11.621299638989168}}
{"episode_reward_max": -4292.75, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -5807.63560090703, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125, -4292.75, -5325.25, -4762.625, -5611.25, -5093.75, -4892.5, -4331.625], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0827916754087656, "mean_inference_ms": 1.8985149589513939, "mean_action_processing_ms": 0.08118824927411189, "mean_env_wait_ms": 951.2406299332142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 6510, "timesteps_this_iter": 0, "agent_timesteps_total": 6510, "timers": {"load_time_ms": 0.178, "load_throughput": 1442232.134, "learn_time_ms": 24.498, "learn_throughput": 10449.971, "update_time_ms": 2.105}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 43.507755279541016, "critic_loss": 13.630517959594727, "alpha_loss": -0.22758962213993073, "alpha_value": [1.2996017932891846], "log_alpha_value": [0.2624233067035675], "target_entropy": [1.076640009880066], "policy_t": 0.3333333134651184, "mean_q": -52.0011100769043, "max_q": -14.038721084594727, "min_q": -196.35400390625}, "td_error": "[5.01866341e+00 8.51615143e+00 1.51467323e+01 1.04063034e+01\n 5.29172516e+00 2.84272575e+00 8.00624847e-01 1.16836281e+01\n 1.07109737e+00 1.54338074e+00 1.57703037e+01 3.89789772e+00\n 2.58467979e+01 4.20710564e+00 2.52997875e+00 2.28576851e+00\n 5.17234421e+00 1.48637257e+01 1.84521408e+01 1.30363331e+01\n 1.32893524e+01 1.67078400e+00 3.89053154e+00 5.05260706e+00\n 7.61349106e+00 1.53217583e+01 1.53358917e+01 4.27627373e+00\n 6.31627941e+00 1.42248802e+01 1.13633080e+01 2.10778999e+00\n 8.39672089e-01 9.54787827e+00 5.33932114e+00 6.58982849e+00\n 2.77931595e+00 1.60248299e+01 6.89514160e+00 1.19157925e+01\n 1.43675690e+01 1.84586124e+01 1.48916054e+00 1.11938229e+01\n 3.22904167e+01 1.35091591e+00 5.48707390e+00 1.23104725e+01\n 1.13706551e+01 7.18795776e-01 3.46123123e+00 2.70274734e+00\n 5.13565063e+00 9.10795498e+00 7.06098747e+00 7.00559616e+00\n 1.16887611e+02 1.02553749e+01 1.99937820e+00 1.69406033e+00\n 1.19569931e+01 6.10490608e+00 1.44169006e+01 7.13745499e+00\n 9.14761353e+00 2.25636864e+00 5.57524109e+00 3.77006531e-01\n 3.96447372e+00 1.74898853e+01 3.89124107e+00 2.11053638e+01\n 6.01194000e+00 8.39657822e+01 4.81994915e+00 2.52655983e+00\n 8.57071304e+00 3.72745705e+00 4.59052063e+02 4.17040062e+00\n 2.30677032e+00 6.15686798e+00 6.95922661e+00 1.02974319e+00\n 6.75917625e+00 5.14665127e+00 1.79244423e+01 5.34275341e+00\n 2.83219242e+00 7.05677032e+00 1.09780636e+01 4.47381973e-01\n 2.67141132e+01 4.73699760e+00 9.81590271e-01 8.60750771e+00\n 1.63092995e+00 1.18138542e+01 1.04688416e+01 3.67334442e+01\n 7.91559029e+00 4.13892174e+00 3.75684547e+00 2.12252426e+00\n 4.13905907e+00 5.23852158e+00 1.31302624e+01 1.99988022e+01\n 1.24100876e+00 1.29019356e+00 2.84155273e+00 2.09290447e+01\n 3.91869926e+00 1.75179138e+01 6.19305229e+00 2.06019020e+01\n 5.04712868e+00 1.56177197e+01 6.76917839e+00 7.64770889e+00\n 9.36015320e+00 2.11664410e+01 1.46997280e+01 8.02707672e+00\n 7.97795105e+00 5.06346512e+00 6.72157669e+00 1.62354641e+01\n 3.33300385e+02 7.06911659e+00 5.66644096e+00 6.38013268e+00\n 1.06635094e+00 8.60306358e+00 1.33949051e+01 1.24602985e+01\n 8.27489281e+00 4.40362835e+00 2.07834435e+01 5.45985603e+00\n 1.94590569e-01 5.71765327e+00 2.11019630e+01 8.69787407e+00\n 9.21135712e+00 5.93993378e+00 4.43259811e+00 1.80443573e+00\n 2.85835838e+00 1.82338142e+00 1.59509201e+01 3.35982590e+01\n 9.16056252e+00 2.45666122e+00 1.04207821e+01 1.39266319e+01\n 5.89789581e+00 4.30955124e+00 1.77429390e+00 3.53901482e+00\n 2.38264236e+01 3.72721825e+01 4.95111465e+00 1.01817989e+01\n 3.10945511e+00 8.00642776e+00 4.53935242e+00 5.94161224e+00\n 5.00778008e+00 1.13124809e+01 1.38084373e+01 9.68615723e+00\n 9.37633514e-01 3.93031311e+00 1.83439255e-01 6.05624771e+00\n 2.36303024e+01 3.45627625e+02 8.62298775e+00 1.34592438e+00\n 4.02534389e+00 6.09869957e+00 2.10548019e+00 7.57968903e+00\n 2.10169048e+01 2.26040649e+00 3.41521645e+00 2.58474731e+00\n 1.52472153e+01 2.26535244e+01 2.56490135e+00 3.27352810e+00\n 1.58756294e+01 1.79912987e+01 5.44193268e-01 1.79732704e+00\n 1.72747002e+01 3.13249397e+00 1.40282860e+01 7.81543732e-01\n 7.68650055e+00 7.03964806e+00 1.10273924e+01 1.17383862e+00\n 6.50325203e+00 2.15735512e+01 4.21419144e+00 1.75829697e+00\n 7.09580421e+00 1.50146770e+01 1.62598038e+00 1.26317520e+01\n 2.81506157e+00 6.61888962e+01 3.22904167e+01 1.10376663e+01\n 1.16919346e+01 1.10067577e+01 8.00351906e+00 6.68117332e+00\n 7.65684414e+00 1.78521919e+01 1.04527092e+00 6.56141281e+00\n 2.38873672e+01 6.30104256e+00 5.45709419e+00 8.42244530e+00\n 1.04433861e+01 6.01194000e+00 6.31307602e-01 1.15023613e+00\n 1.90120831e+01 2.79274368e+00 3.54104805e+00 1.32072372e+01\n 6.71100616e+00 7.92790680e+01 5.86815643e+00 2.07803535e+00\n 2.70549774e+00 1.96740475e+01 4.68421364e+00 1.55523682e+00\n 1.02273941e+00 2.81463432e+00 3.96263981e+00 2.75438385e+01\n 9.54052353e+00 1.40882454e+01 2.73170376e+00 8.61486816e+00\n 9.39431763e+00 9.32665730e+00 4.11515427e+00 2.19200859e+01]", "mean_td_error": 14.116805076599121, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6510, "num_agent_steps_sampled": 6510, "num_steps_trained": 183296, "num_agent_steps_trained": 183296, "last_target_update_ts": 6510, "num_target_updates": 716, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21, "training_iteration": 6, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-19-00", "timestamp": 1720124340, "time_this_iter_s": 201.5670280456543, "time_total_s": 1281.5712842941284, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9e2430>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9e2d60>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9e26a0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9e2670>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 1281.5712842941284, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.554703832752615, "ram_util_percent": 11.790243902439023}}
{"episode_reward_max": -4292.75, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -5807.63560090703, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125, -4292.75, -5325.25, -4762.625, -5611.25, -5093.75, -4892.5, -4331.625], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0827916754087656, "mean_inference_ms": 1.8985149589513939, "mean_action_processing_ms": 0.08118824927411189, "mean_env_wait_ms": 951.2406299332142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 7511, "timesteps_this_iter": 0, "agent_timesteps_total": 7511, "timers": {"load_time_ms": 0.177, "load_throughput": 1449435.508, "learn_time_ms": 24.811, "learn_throughput": 10317.972, "update_time_ms": 2.064}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 48.375396728515625, "critic_loss": 10.333806991577148, "alpha_loss": -0.2766333818435669, "alpha_value": [1.3683620691299438], "log_alpha_value": [0.31396907567977905], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -57.571990966796875, "max_q": -22.394771575927734, "min_q": -245.02748107910156}, "td_error": "[1.46618614e+01 2.20294952e+00 1.33904247e+01 3.12181282e+00\n 8.18944550e+00 4.12835884e+00 1.09013271e+00 3.21544266e+00\n 4.18972206e+00 1.02666454e+01 1.08192520e+01 1.07965622e+01\n 1.81755257e+00 9.94402313e+00 2.13409233e+00 1.12867775e+01\n 1.31326389e+01 4.81109619e+00 6.09402847e+00 1.06530704e+01\n 1.45853233e+01 1.31600304e+01 5.53048706e+00 3.60704041e+00\n 5.14363098e+00 1.88622894e+01 6.69931602e+00 2.49173965e+01\n 1.29417038e+01 5.05342865e+00 1.39713287e+00 2.64896584e+00\n 5.51685333e-01 1.27231216e+00 3.14007607e+01 7.15576172e+00\n 5.53048706e+00 9.96045876e+00 1.12847023e+01 5.19329643e+00\n 3.59890480e+01 7.11360931e-01 8.54108047e+00 2.98160553e-01\n 5.23347664e+00 6.37482452e+00 9.72255707e-01 9.94981956e+00\n 7.31394958e+00 3.27901993e+01 7.57061005e-01 1.11039371e+01\n 1.91139793e+01 2.05515785e+01 9.30905628e+00 2.46185493e+00\n 1.34672070e+01 2.13018417e+00 4.41188812e-01 6.21031284e+00\n 6.41900063e+00 7.96505547e+00 1.85614929e+01 5.59574890e+00\n 3.27523422e+00 3.09109116e+01 1.49803658e+01 3.44778061e+00\n 6.07870102e+00 3.97639751e+00 4.40356407e+01 1.17718697e+00\n 7.85525131e+00 4.71599197e+00 5.06266403e+00 8.72226143e+00\n 3.08588467e+01 3.57353973e+00 5.12564888e+01 1.08248520e+00\n 1.35215950e+00 2.72226086e+01 7.37406063e+00 2.14578362e+01\n 3.55120468e+00 5.28973961e+00 3.03509903e+00 2.31247330e+00\n 2.31178665e+00 2.58604431e+00 8.40493011e+00 7.84681129e+00\n 9.01208878e-01 9.85994339e+00 9.60189819e-01 9.52066422e-01\n 2.69439793e+00 2.10143814e+01 1.52539482e+01 5.24411774e+00\n 1.24289722e+01 3.24719086e+02 4.26259613e+00 2.33146152e+01\n 5.61381340e+00 8.87649536e+00 5.53191185e+00 1.11995926e+01\n 1.11816521e+01 3.53475571e+00 8.89329147e+00 8.11646652e+00\n 5.68925858e+00 2.03720684e+01 1.03631935e+01 4.75835991e+00\n 4.34023857e+00 2.77057266e+00 3.72026443e-01 5.98821068e+00\n 1.59663239e+01 1.15245762e+01 5.90658569e+00 2.26679058e+01\n 1.23433075e+01 6.70731354e+00 2.77280235e+00 2.65333366e+00\n 6.03810883e+00 1.50766354e+01 8.77511597e+00 3.97066116e+00\n 2.89523315e+00 7.25613403e+00 1.38183212e+00 2.67952728e+00\n 3.97957039e+00 1.56687927e+00 1.18658066e-01 4.79970360e+00\n 4.90724564e-01 1.47652359e+01 3.74493027e+00 1.98259525e+01\n 6.55989075e+00 5.83232880e-01 1.32515907e+00 1.25139484e+01\n 4.67793083e+00 2.60117607e+01 7.63389587e+00 9.48068619e-01\n 3.79486275e+00 2.06992188e+01 4.74998474e+00 2.66445179e+01\n 4.16420746e+00 4.13773727e+00 1.40529442e+00 4.34165573e+00\n 1.95613670e+00 1.34339256e+01 2.11493950e+01 1.09357853e+01\n 1.05867310e+01 3.02297840e+01 4.38774643e+01 8.56804848e+00\n 5.70259476e+00 2.96543121e-01 2.62500057e+01 6.73891068e-01\n 3.05340958e+00 1.77204590e+01 1.12882290e+01 4.21711540e+00\n 8.02250290e+00 4.81305313e+00 2.68081665e+00 5.64369965e+00\n 9.79869843e-01 1.25682278e+01 9.56894684e+00 1.21229095e+01\n 6.58128738e-01 6.31545258e+00 6.95312500e-01 9.94476318e+00\n 1.58224697e+01 7.82153130e+00 7.56863403e+00 1.47546768e+01\n 2.06666946e+00 5.64809227e+00 1.27832756e+01 7.64348984e+00\n 3.63913727e+00 4.86028481e+00 1.17278957e+00 1.07789154e+01\n 1.03403912e+01 1.95280266e+00 6.48837280e+00 1.61813736e+00\n 1.01018944e+01 3.02766418e+00 7.15471268e+00 6.88860989e+00\n 3.08016205e+00 5.07753754e+00 3.10880928e+01 1.94596291e+01\n 4.03991699e-01 7.80576706e-01 9.81335258e+00 1.61048508e+00\n 1.11258316e+01 1.00569878e+01 1.82269344e+01 6.99859047e+00\n 5.84910774e+00 7.86592178e+01 3.34430504e+00 1.73855877e+00\n 1.91433792e+01 3.01607132e-01 4.90648365e+00 4.39268990e+01\n 1.19652767e+01 1.61851978e+01 1.93554554e+01 3.64862251e+00\n 5.21278000e+00 3.94900322e-01 6.53094940e+01 1.32343102e+00\n 1.80264473e+00 1.16278267e+01 1.46833849e+01 1.32252464e+01\n 9.32467575e+01 5.91080284e+00 1.05779839e+00 3.74945354e+00\n 3.67599678e+00 4.03756142e+00 1.99892807e+00 1.70577660e+01\n 4.23038864e+00 1.77063560e+00 1.65831661e+00 2.42784576e+01\n 1.63665962e+00 9.93011093e+00 1.76134109e-01 1.34186363e+00]", "mean_td_error": 10.813802719116211, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7511, "num_agent_steps_sampled": 7511, "num_steps_trained": 219904, "num_agent_steps_trained": 219904, "last_target_update_ts": 7511, "num_target_updates": 859, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21, "training_iteration": 7, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-22-05", "timestamp": 1720124525, "time_this_iter_s": 185.21736001968384, "time_total_s": 1466.7886443138123, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9f9370>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9f9e50>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9f9700>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9f98b0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 1466.7886443138123, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.596590909090908, "ram_util_percent": 11.327651515151517}}
{"episode_reward_max": -2462.75, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -5135.423129251701, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125, -4292.75, -5325.25, -4762.625, -5611.25, -5093.75, -4892.5, -4331.625, -2731.125, -2863.0, -2462.75, -3045.25, -3655.5, -4148.25, -2925.625], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.092642338500384, "mean_inference_ms": 1.8954119032003631, "mean_action_processing_ms": 0.08184952062087666, "mean_env_wait_ms": 952.9399830716453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 8512, "timesteps_this_iter": 0, "agent_timesteps_total": 8512, "timers": {"load_time_ms": 0.169, "load_throughput": 1511673.693, "learn_time_ms": 24.692, "learn_throughput": 10367.556, "update_time_ms": 2.103}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 50.86175537109375, "critic_loss": 12.33816909790039, "alpha_loss": -0.3290368914604187, "alpha_value": [1.4383264780044556], "log_alpha_value": [0.36382484436035156], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -60.58713150024414, "max_q": -24.109569549560547, "min_q": -166.27525329589844}, "td_error": "[1.18750954e+01 1.63906860e+00 6.58433342e+00 1.18037529e+01\n 6.25849915e+00 2.66854095e+00 1.91720352e+01 1.37636185e+01\n 2.49698105e+01 6.02743912e+00 2.05707397e+01 6.30510330e-01\n 5.62384224e+00 1.81049156e+00 1.00530720e+00 2.47134209e+00\n 3.74651718e+01 9.19568253e+00 4.61393356e+00 1.72793312e+01\n 1.62087727e+01 1.94572144e+01 8.41985703e-01 1.60617943e+01\n 1.41644211e+01 1.87244606e+00 1.48773773e+02 5.36366081e+00\n 1.72905350e+00 9.55879364e+01 5.04587364e+00 6.21363831e+00\n 3.08935165e+00 2.04541016e+00 3.19418526e+00 1.65691738e+01\n 7.02659607e-01 4.63066292e+00 2.19904900e+01 1.81598854e+00\n 2.87232971e+00 4.40425491e+00 4.63066292e+00 1.26683617e+00\n 6.90321159e+00 2.73465652e+01 4.90533257e+00 1.22832355e+01\n 4.41065598e+00 2.57277489e+00 1.13448563e+01 1.23456383e+01\n 1.86957550e+01 1.62070084e+00 2.76983643e+00 5.74239731e+00\n 1.06777630e+01 2.71884918e-01 1.07571507e+01 3.79300690e+00\n 7.40822983e+00 3.12034798e+00 5.97677803e+00 1.07205849e+01\n 9.06675339e+00 2.58293343e+01 8.67058372e+00 6.15662193e+00\n 4.05047989e+00 7.85925102e+00 1.65691738e+01 7.29126358e+00\n 1.30565681e+01 3.62104034e+00 1.45300293e+00 2.42310085e+01\n 5.17193222e+00 1.20452099e+01 1.10055943e+01 1.12895966e-01\n 1.17056503e+01 2.50014648e+01 4.10704613e+00 9.63421822e-01\n 8.57200813e+00 1.67765770e+01 1.55781937e+00 1.70091019e+01\n 1.64297962e+00 2.00585556e+00 1.99478588e+01 1.81598854e+00\n 3.44016647e+00 1.52190399e+00 3.95530891e+00 5.83244705e+00\n 3.05149441e+01 1.33604126e+01 2.12510681e+00 1.97643280e-01\n 2.10434628e+01 1.57863102e+01 1.01209145e+01 4.42467117e+00\n 2.82229233e+00 7.55900764e+00 5.28477097e+01 2.40820923e+01\n 2.89371147e+01 9.78861618e+00 6.37676239e+00 1.00487041e+01\n 1.27838192e+01 1.42308426e+00 3.82555237e+02 6.89936066e+00\n 1.18566418e+01 2.89666367e+00 1.13655682e+01 2.32940216e+01\n 4.43399429e+00 7.81911469e+00 3.49884605e+00 1.37176514e+01\n 4.22722149e+00 1.32685852e+00 1.26334877e+01 6.98847771e+00\n 1.24959717e+01 1.45477180e+01 2.06683331e+01 1.65705872e+00\n 3.82127533e+01 5.86967087e+00 1.01740265e+00 1.16669960e+01\n 1.15223312e+00 2.36115952e+01 3.69662094e+00 9.39451408e+00\n 2.56752205e+00 7.19516754e-01 2.97326088e+00 2.28683472e+00\n 7.67137909e+00 2.05204048e+01 3.49115181e+00 3.03598709e+01\n 6.27305222e+00 1.09953804e+01 1.38984203e+01 1.25565338e+01\n 4.89643478e+00 1.03888321e+01 3.19160843e+00 4.19066429e+00\n 1.40775509e+01 6.76780701e-01 6.07052422e+00 4.98964310e+00\n 1.25610981e+01 1.84007721e+01 1.35066299e+02 4.92581558e+00\n 7.75312347e+01 1.16190472e+01 1.42250633e+00 7.72265625e+00\n 1.45348473e+01 1.44452534e+01 1.00799999e+01 2.77545471e+01\n 5.77758408e+00 1.23524475e+00 3.53688126e+01 2.65413284e+00\n 1.28264351e+01 9.80781555e+00 1.11413765e+00 2.76871490e+00\n 2.55480461e+01 7.99221039e-01 5.11544609e+00 1.63785934e+00\n 2.36236935e+01 7.25582123e-01 4.74128628e+00 1.05710697e+01\n 1.00609341e+01 1.76056252e+01 2.68646812e+00 1.23694229e+00\n 3.96246147e+00 1.43568878e+01 1.36472702e-01 1.91974163e+01\n 8.89578247e+00 6.98049545e-01 1.53451729e+00 9.26691055e-01\n 2.06711197e+00 1.61822510e+00 2.22746468e+00 5.38566589e+00\n 1.42328529e+01 3.10117760e+01 6.43816757e+00 1.56575584e+00\n 7.03538513e+00 5.70672226e+00 2.71884918e-01 2.79062462e+00\n 2.34950104e+01 2.22145348e+01 5.30653191e+00 1.02754974e+00\n 4.97778320e+00 7.00184441e+00 2.11914330e+01 4.35405350e+00\n 5.44770908e+00 6.07839775e+00 1.51571255e+01 6.46981239e-01\n 1.32330322e+00 5.88636017e+00 4.42577171e+00 6.33596039e+00\n 1.82725067e+01 3.59009552e+01 1.60602989e+01 6.05457687e+00\n 2.86987305e-01 9.98052597e-01 3.28707123e+00 1.23715191e+01\n 3.43764153e+01 6.76242828e-01 3.22228050e+00 1.51260891e+01\n 1.62718639e+01 2.18181648e+01 2.52229824e+01 5.12071228e+00\n 1.36486969e+01 2.33414268e+00 2.30749798e+00 1.12064934e+01\n 2.99355717e+01 7.34612083e+00 3.04258156e+00 1.41050434e+01\n 4.41764641e+00 9.52622833e+01 8.28433990e-01 1.11553001e+00]", "mean_td_error": 12.819266319274902, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8512, "num_agent_steps_sampled": 8512, "num_steps_trained": 256512, "num_agent_steps_trained": 256512, "last_target_update_ts": 8512, "num_target_updates": 1002, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28, "training_iteration": 8, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-25-49", "timestamp": 1720124749, "time_this_iter_s": 223.7533404827118, "time_total_s": 1690.541984796524, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9ef280>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9ef2e0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9ef310>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9ef370>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 1690.541984796524, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.694062500000001, "ram_util_percent": 11.865}}
{"episode_reward_max": -2462.75, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -5135.423129251701, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125, -4292.75, -5325.25, -4762.625, -5611.25, -5093.75, -4892.5, -4331.625, -2731.125, -2863.0, -2462.75, -3045.25, -3655.5, -4148.25, -2925.625], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.092642338500384, "mean_inference_ms": 1.8954119032003631, "mean_action_processing_ms": 0.08184952062087666, "mean_env_wait_ms": 952.9399830716453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 9513, "timesteps_this_iter": 0, "agent_timesteps_total": 9513, "timers": {"load_time_ms": 0.175, "load_throughput": 1461668.696, "learn_time_ms": 24.83, "learn_throughput": 10309.977, "update_time_ms": 2.105}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 59.063011169433594, "critic_loss": 9.346115112304688, "alpha_loss": -0.3638795018196106, "alpha_value": [1.5100826025009155], "log_alpha_value": [0.4125016927719116], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -68.46475982666016, "max_q": -27.420543670654297, "min_q": -272.1069030761719}, "td_error": "[1.3428440e+01 4.7422466e+00 3.2015762e+00 7.9322403e+01 3.3599949e+00\n 4.4659615e+00 3.7818871e+00 5.2469921e+00 7.7274551e+00 1.1240639e+01\n 2.6391939e+01 6.9459305e+00 9.4113350e-01 4.0993156e+00 8.9789124e+00\n 8.7769279e+00 4.3575439e+00 1.2174896e+01 2.2266319e+01 7.4200363e+00\n 1.2476067e+01 1.5581284e+00 1.5198223e+01 8.8346577e+00 2.9337692e+00\n 4.9857559e+00 6.0070038e-02 4.6831131e-01 6.4782852e+01 4.6863518e+00\n 6.5012550e+00 1.9946365e+00 1.2225571e+00 1.7623119e+00 9.0417137e+00\n 2.4280725e+01 5.0722561e+00 6.5387535e-01 7.1414051e+00 4.1072083e-01\n 2.3748524e+01 1.6184500e+01 7.6956520e+00 1.3360075e+01 2.2180414e+01\n 3.5575508e+01 3.5729790e+00 1.4308125e+01 2.9326115e+00 2.4827999e+01\n 1.4098930e+00 1.5447649e+01 7.4219894e+00 5.4514847e+00 1.7297287e+00\n 3.4344353e+01 5.0638981e+00 1.2832556e+01 3.4553852e+01 4.8224754e+00\n 4.1564159e+00 8.8890648e+00 3.1247902e-01 2.6501198e+00 7.8799667e+00\n 1.3063297e+01 7.3161888e+00 1.1377602e+00 1.8928431e+01 6.0418396e+00\n 1.9452202e+01 4.0204964e+00 2.5380478e+00 1.3357449e+00 5.4007702e+00\n 8.3855400e+00 1.6562094e+01 3.7845478e+00 2.2577305e+00 1.1291319e+01\n 1.8670578e+00 1.7808456e+00 5.2807102e+00 5.3314590e-01 3.3989552e+01\n 7.6956520e+00 8.6203823e+00 3.4153271e+00 7.0181570e+00 3.0668564e+00\n 5.0941467e-01 8.3014565e+00 3.3203629e+01 1.8447380e+00 1.5323656e+01\n 5.7974167e+00 8.3482933e-01 1.2986824e+01 2.3448639e+00 9.3999863e-01\n 1.3357449e+00 2.4434147e+00 1.9023991e+00 2.2031288e+00 4.6154423e+00\n 4.9669933e+00 1.4477730e+00 6.6429653e+00 8.8930969e+00 1.2439720e+01\n 1.2645950e+01 3.9778709e+00 4.9091873e+00 1.0828381e+01 7.7194595e-01\n 1.3106638e+01 7.1681423e+00 2.1636063e+01 1.4816425e+01 2.5328865e+01\n 7.2017632e+00 1.0205898e+01 5.5875225e+00 5.9474945e-01 2.1615734e+00\n 2.3470383e+00 4.5336113e+00 1.1820007e+01 1.4180508e+00 4.1249046e+00\n 9.3838959e+00 6.5387535e-01 3.0945396e-01 1.3289585e+00 1.7113132e+00\n 3.6493874e+00 1.6574402e+00 3.6080246e+00 6.6182365e+00 8.2117538e+00\n 6.4078033e+01 2.0819658e+01 1.0982168e+01 1.6590576e+00 6.0323215e+01\n 8.3915367e+00 7.2025948e+00 7.5924797e+00 5.0005608e+00 4.8223648e+00\n 8.2816772e+00 9.3737297e+00 6.1815510e+00 5.5525894e+00 5.2542477e+00\n 7.5257359e+00 4.8951283e+00 1.1146507e+00 1.2356060e+01 1.3352432e+00\n 9.4080620e+00 1.7953785e+01 2.4256706e+00 7.6194191e-01 2.3841217e+01\n 1.2873802e+00 2.9345945e+01 9.0825806e+00 1.3470707e+00 2.3000011e+00\n 6.1306705e+00 8.9795704e+00 1.8100159e+01 2.5024185e+00 1.4535095e+01\n 3.4199486e+00 1.9077356e+01 1.9859772e+00 2.8217525e+01 7.5876236e+00\n 1.3709019e+01 2.8950977e+01 3.7668419e+00 1.0498291e+01 3.5321045e+01\n 8.7710381e+00 1.8344498e-01 8.2606926e+00 6.2783546e+00 4.9313412e+00\n 5.9588032e+00 1.2910419e+01 9.1283169e+00 1.3470707e+00 5.0012131e+00\n 4.4632149e+00 5.3971863e-01 1.0139984e+01 2.7465675e+01 5.4520363e+01\n 1.2186863e+01 6.6222591e+00 2.3394680e+00 2.7767727e+01 1.0327763e+01\n 7.8582993e+00 7.7615585e+00 9.3449402e-01 1.0174717e+01 6.4370918e-01\n 1.2823990e+01 8.5881615e-01 6.0230217e+00 3.6785393e+00 3.9328499e+00\n 7.6424675e+00 1.5350441e+01 1.9662514e+00 4.3980141e+00 1.0113682e+01\n 7.2667150e+00 1.7855244e+01 4.6373825e+00 1.7281254e+01 8.2990246e+00\n 6.4775085e-01 3.7954082e+00 6.6925945e+00 1.6773949e+01 7.9578972e+00\n 1.9637566e+00 4.7242928e-01 3.9694538e+00 1.9714985e+00 1.3239481e+01\n 1.8107859e+01 7.9461060e+00 4.7545700e+00 6.1810760e+00 1.7131191e+01\n 4.8315144e+00 2.8484325e+00 5.4754410e+00 1.5127832e+01 4.1795456e+01\n 4.5502968e+00 5.9144939e+01 3.4274235e+00 1.9751503e+01 9.9182796e+00\n 4.9914341e+00 1.0411047e+01 2.5300102e+00 1.6013441e+01 1.9911434e+01\n 1.1972889e+01]", "mean_td_error": 9.830451965332031, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9513, "num_agent_steps_sampled": 9513, "num_steps_trained": 293120, "num_agent_steps_trained": 293120, "last_target_update_ts": 9513, "num_target_updates": 1145, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28, "training_iteration": 9, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-28-51", "timestamp": 1720124931, "time_this_iter_s": 182.17766094207764, "time_total_s": 1872.7196457386017, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7b9d66a0>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7b9d6f70>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7b9d6d00>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7b9d6400>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 1872.7196457386017, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.474903474903474, "ram_util_percent": 11.757142857142856}}
{"episode_reward_max": -2462.75, "episode_reward_min": -8173.355952380953, "episode_reward_mean": -5135.423129251701, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8173.355952380953, -7609.847619047619, -7243.0011904761905, -6117.030952380952, -8060.101190476191, -6785.866666666667, -7052.894047619047, -4499.5, -4527.375, -4910.5, -4746.75, -4939.0, -6359.25, -6626.125, -4292.75, -5325.25, -4762.625, -5611.25, -5093.75, -4892.5, -4331.625, -2731.125, -2863.0, -2462.75, -3045.25, -3655.5, -4148.25, -2925.625], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.092642338500384, "mean_inference_ms": 1.8954119032003631, "mean_action_processing_ms": 0.08184952062087666, "mean_env_wait_ms": 952.9399830716453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 10514, "timesteps_this_iter": 0, "agent_timesteps_total": 10514, "timers": {"load_time_ms": 0.17, "load_throughput": 1508276.196, "learn_time_ms": 24.749, "learn_throughput": 10343.766, "update_time_ms": 2.078}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "actor_loss": 56.740943908691406, "critic_loss": 10.32288932800293, "alpha_loss": -0.40759536623954773, "alpha_value": [1.5836708545684814], "log_alpha_value": [0.46007275581359863], "target_entropy": [1.076640009880066], "policy_t": 0.3333333432674408, "mean_q": -65.89359283447266, "max_q": -31.935565948486328, "min_q": -166.82562255859375}, "td_error": "[4.32373238e+00 2.94650269e+00 1.51566734e+01 2.59579849e+01\n 1.26419067e+00 9.47498322e-01 1.41254654e+01 2.29101448e+01\n 4.33006859e+00 6.19435310e+00 3.28001022e+00 9.28518295e-01\n 7.70151138e-01 1.36899185e+00 4.03177261e+00 1.69587440e+01\n 2.54475403e+00 3.35866928e+00 8.17320251e+00 1.09608841e+00\n 3.07600288e+01 1.25083733e+00 1.26867676e+00 2.08684196e+01\n 6.53239632e+00 1.24403267e+01 6.72025681e+00 1.11058197e+01\n 1.26745453e+01 1.23207664e+00 2.21783371e+01 1.76755600e+01\n 8.64177704e-01 2.18687439e+00 3.03538132e+00 2.53984890e+01\n 9.90371895e+00 1.07381821e-01 6.41308212e+00 2.73097763e+01\n 1.51088352e+01 5.20129776e+00 1.10932350e+01 6.47058487e+00\n 7.36211777e+00 5.65668564e+01 4.90962982e-01 9.14945602e-01\n 4.81212997e+00 1.44146919e+00 1.64056892e+01 1.09136677e+01\n 1.59496689e+00 1.04011784e+01 8.75641251e+00 2.30513992e+01\n 1.36303139e+01 6.23170280e+00 5.58133507e+00 5.56262779e+00\n 5.01154709e+00 1.72222481e+01 5.80810165e+00 4.33120346e+00\n 1.33605652e+01 1.05903435e+00 3.94039917e+00 1.01835251e+01\n 4.66285706e+00 1.85861626e+01 1.62296867e+00 2.99932289e+00\n 1.19767761e+00 6.40244865e+00 2.63394737e+00 1.38980675e+01\n 1.34817448e+01 1.54027557e+00 1.37066288e+01 4.76479721e+00\n 6.63178635e+00 3.59857178e+00 1.23707924e+01 4.01643066e+01\n 4.67504692e+00 7.09238625e+00 2.55660629e+00 7.46862602e+00\n 1.44896576e+02 2.16250992e+00 5.88030624e+00 7.47863770e-01\n 4.24956703e+00 1.58812389e+01 1.50351696e+01 9.82162476e-01\n 2.32370567e+00 8.61333275e+00 6.12156677e+00 3.36902809e+00\n 5.97187614e+00 2.18516922e+00 3.14829121e+01 2.87628288e+01\n 5.48107147e+00 3.86399460e+01 1.80360603e+00 1.56949768e+01\n 1.81970406e+01 4.62545013e+00 7.15890503e+00 7.61318207e+00\n 8.15417290e+00 1.07155724e+01 1.36303139e+01 1.98292160e+01\n 7.92787933e+00 1.74680138e+00 1.40320644e+01 2.20946312e+00\n 1.21750641e+00 5.06583977e+00 6.68220711e+00 2.51683197e+01\n 2.22452164e+00 3.98603477e+01 7.24628448e+00 3.20185280e+00\n 9.42268372e-01 2.07719040e+00 5.06583977e+00 1.65507889e+01\n 5.12625847e+01 7.80498505e+00 2.36094589e+01 1.43538971e+01\n 1.98401070e+00 2.01388168e+00 1.18667831e+01 1.13580589e+01\n 1.04921284e+01 3.17265129e+00 4.50168610e-01 9.24765778e+00\n 1.24866676e+00 1.04726582e+01 1.81279297e+01 9.45442200e-01\n 1.68419647e+00 2.05640450e+01 1.50275421e+00 7.74710846e+00\n 1.63867340e+01 5.84986496e+00 1.39336319e+01 3.42901802e+00\n 2.62813950e+00 9.56399536e+00 5.85826492e+00 1.81189804e+01\n 1.54121246e+01 1.83794022e+00 1.43209076e+00 4.80751991e+00\n 1.19026337e+01 3.50962372e+01 2.04207802e+01 2.71949959e+00\n 1.33144569e+00 2.64347801e+01 1.48243675e+01 1.19055347e+01\n 2.42609787e+00 4.59258652e+00 7.26014900e+00 2.36894989e+00\n 2.05103893e+01 2.45075035e+00 6.99018478e-01 3.88845634e+00\n 1.12674301e+02 9.39874649e-01 3.95389557e+00 1.03490505e+01\n 6.06414795e+00 1.76223183e+00 6.86793518e+00 3.68457031e+00\n 1.90137482e+00 7.96566772e+00 1.65569534e+01 1.34702682e+00\n 3.38970795e+01 2.40142441e+00 4.40505219e+00 4.18274117e+00\n 3.08698845e+00 2.50304413e+00 1.03259048e+01 1.38581085e+00\n 9.63096619e-01 6.27361298e-01 1.19026337e+01 1.91845512e+01\n 5.54475594e+00 1.89482269e+01 1.27090454e+00 2.07719040e+00\n 8.93416786e+00 6.09194946e+00 1.31554756e+01 1.39574509e+01\n 6.52999687e+00 2.23417473e+00 1.20150318e+01 4.84390068e+00\n 2.57551384e+00 4.21043777e+00 2.72481155e+00 1.03319817e+01\n 4.62433624e+00 3.03441238e+00 2.51397514e+00 2.54362679e+00\n 2.09837761e+01 9.47419357e+00 3.73770866e+01 7.88879395e-01\n 2.60861969e+00 5.51564789e+00 7.00226784e+00 1.69632378e+01\n 2.99072266e-01 1.12674301e+02 1.90707321e+01 4.61585045e+00\n 1.37831116e+01 9.12304878e+00 1.71554604e+01 4.21766281e+00\n 5.09006119e+01 2.72003365e+00 2.53523579e+01 1.06170082e+00\n 1.99038048e+01 7.39308167e+00 1.41481285e+01 1.17536736e+00\n 1.07006264e+01 2.17068024e+01 1.56206398e+01 4.42777290e+01\n 1.20968437e+00 6.39961243e-01 1.70297852e+01 1.40439034e+00]", "mean_td_error": 10.806941986083984, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10514, "num_agent_steps_sampled": 10514, "num_steps_trained": 329728, "num_agent_steps_trained": 329728, "last_target_update_ts": 10514, "num_target_updates": 1288, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 28, "training_iteration": 10, "trial_id": "a301a_00000", "experiment_id": "4ce32794bcdf445b8035f31f14097d26", "date": "2024-07-04_21-32-56", "timestamp": 1720125176, "time_this_iter_s": 244.95161867141724, "time_total_s": 2117.671264410019, "pid": 2177236, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 256, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x77ff7bc59cd0>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x77ff7bc9ae20>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x77ff7bc9ad30>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x77ff7bc9ab20>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.SACTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "twin_q": true, "use_state_preprocessor": -1, "Q_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "buffer_size": 1000000, "store_buffer_in_checkpoints": false, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "grad_clip": null, "learning_starts": 1500, "target_network_update_freq": 0, "worker_side_prioritization": false, "_deterministic_loss": false, "_use_beta_distribution": false}, "time_since_restore": 2117.671264410019, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.824571428571428, "ram_util_percent": 11.992571428571427}}
