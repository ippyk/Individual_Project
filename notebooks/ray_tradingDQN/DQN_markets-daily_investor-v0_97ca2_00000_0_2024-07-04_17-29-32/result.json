{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 1008, "timesteps_this_iter": 0, "agent_timesteps_total": 1008, "timers": {"load_time_ms": 0.176, "load_throughput": 181375.308, "learn_time_ms": 33.622, "learn_throughput": 951.75, "update_time_ms": 1.755}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.861229419708252, "mean_q": -0.5222335457801819, "min_q": -1.9393243789672852, "max_q": 0.8081510066986084, "cur_lr": 0.0005}, "td_error": "[3.9054943e+01 9.7777252e+00 3.7247570e+01 4.0733910e+01 2.0515804e+00\n 6.3684716e+00 1.3734583e+01 9.3162096e-01 8.9958038e+01 3.3214095e+00\n 4.6495929e+00 2.5079842e+01 2.8662621e+01 2.2874352e+01 9.4859009e+00\n 3.7053055e+01 6.0224199e+00 3.0712744e+01 2.1997404e+01 3.4642756e-02\n 3.8369450e+01 2.3663954e+01 2.6628876e+01 2.9508312e+01 2.3053164e+01\n 2.3378386e+01 2.6875023e+01 2.0376220e+00 1.6581404e+01 1.0644051e+01\n 2.2668741e+01 3.5222325e+00]", "mean_td_error": 21.146364212036133, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1008, "num_agent_steps_sampled": 1008, "num_steps_trained": 32, "num_agent_steps_trained": 32, "last_target_update_ts": 1008, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-32-27", "timestamp": 1720110747, "time_this_iter_s": 163.58492374420166, "time_total_s": 163.58492374420166, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390d4070>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390d40a0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390d41c0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390d4220>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 163.58492374420166, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 14.723504273504274, "ram_util_percent": 8.564529914529915}}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 2016, "timesteps_this_iter": 0, "agent_timesteps_total": 2016, "timers": {"load_time_ms": 0.176, "load_throughput": 182138.32, "learn_time_ms": 8.714, "learn_throughput": 3672.248, "update_time_ms": 1.803}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5166871547698975, "mean_q": -12.275896072387695, "min_q": -26.321392059326172, "max_q": -5.862059116363525, "cur_lr": 0.0005}, "td_error": "[19.29794    8.877437  13.4284935 26.298317  13.151432   5.596451\n 25.61676   46.975624  25.322151  37.07136   10.004037  30.092516\n -3.3395672 46.893166  45.713707  10.259668  15.681894  17.215855\n 23.61069   44.154095  -6.3011856 39.257767  52.57684   15.357442\n 16.643417  60.21051   42.500248  11.456938  18.149475  53.323154\n 25.61676   22.54629  ]", "mean_td_error": 25.414365768432617, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2016, "num_agent_steps_sampled": 2016, "num_steps_trained": 1184, "num_agent_steps_trained": 1184, "last_target_update_ts": 2016, "num_target_updates": 3, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-35-57", "timestamp": 1720110957, "time_this_iter_s": 210.48923897743225, "time_total_s": 374.0741627216339, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390ad430>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390ad490>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390ad580>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390ad5e0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 374.0741627216339, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.320999999999998, "ram_util_percent": 9.279666666666667}}
{"episode_reward_max": -6481.315476190475, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -7214.6872448979575, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571], "episode_lengths": [301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942053601986423, "mean_inference_ms": 1.9380688391987224, "mean_action_processing_ms": 0.06431567318877619, "mean_env_wait_ms": 940.3467032037053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 3024, "timesteps_this_iter": 0, "agent_timesteps_total": 3024, "timers": {"load_time_ms": 0.17, "load_throughput": 187717.102, "learn_time_ms": 8.595, "learn_throughput": 3722.996, "update_time_ms": 1.81}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.440338373184204, "mean_q": -38.02645492553711, "min_q": -63.420074462890625, "max_q": -13.121039390563965, "cur_lr": 0.0005}, "td_error": "[ 28.559166   -12.977974    22.713533    21.30442    -12.248001\n -20.658672    24.080585    31.760887   -18.554558    20.354439\n  -1.7779465   -2.1750278    1.1145287   34.1972       3.0691185\n -15.159203     6.170105     9.638697    16.650227    23.114689\n   6.3571053   28.817932    -7.583908     0.64624214  20.508087\n  13.116947     9.64349     19.311132   -24.645077    -6.2585106\n   7.4488373   28.038322  ]", "mean_td_error": 7.9555253982543945, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3024, "num_agent_steps_sampled": 3024, "num_steps_trained": 2336, "num_agent_steps_trained": 2336, "last_target_update_ts": 3024, "num_target_updates": 5, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7, "training_iteration": 3, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-38-36", "timestamp": 1720111116, "time_this_iter_s": 158.93159317970276, "time_total_s": 533.0057559013367, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390b3d60>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390b3dc0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390b3df0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390b3e50>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 533.0057559013367, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.076211453744493, "ram_util_percent": 9.989427312775328}}
{"episode_reward_max": -6481.315476190475, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -7214.6872448979575, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571], "episode_lengths": [301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8942053601986423, "mean_inference_ms": 1.9380688391987224, "mean_action_processing_ms": 0.06431567318877619, "mean_env_wait_ms": 940.3467032037053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 4032, "timesteps_this_iter": 0, "agent_timesteps_total": 4032, "timers": {"load_time_ms": 0.187, "load_throughput": 170695.317, "learn_time_ms": 8.729, "learn_throughput": 3665.779, "update_time_ms": 1.822}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.510960340499878, "mean_q": -46.980960845947266, "min_q": -89.41619873046875, "max_q": -18.161895751953125, "cur_lr": 0.0005}, "td_error": "[-3.3272820e+00  6.5307617e-02 -1.5982143e+01  2.3067997e+01\n  1.7128685e+01  2.6536148e+01  1.5829121e+01 -9.2259979e+00\n  5.8312843e+01  1.7192535e+00  1.8195724e-01  1.2117638e+01\n  1.8132996e+01 -9.1040154e+00  2.2714615e+01  3.4060936e+01\n  3.3800011e+00  3.1401947e+01  1.9543286e+02  3.3987843e+01\n  2.7259323e+01  6.6314697e-02 -7.8423691e+00  6.6561871e+00\n  5.7046509e-01  4.0031666e+01 -2.2456139e+01  3.4610239e+02\n  1.2010574e+00  8.2774353e-01 -6.6780777e+00 -1.3086412e+01]", "mean_td_error": 25.90884017944336, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4032, "num_agent_steps_sampled": 4032, "num_steps_trained": 3488, "num_agent_steps_trained": 3488, "last_target_update_ts": 4032, "num_target_updates": 7, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7, "training_iteration": 4, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-41-55", "timestamp": 1720111315, "time_this_iter_s": 198.7709789276123, "time_total_s": 731.776734828949, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390b3880>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390b3610>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390b3220>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390b3c70>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 731.776734828949, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.871126760563381, "ram_util_percent": 10.821830985915494}}
{"episode_reward_max": -5729.0, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -7118.986479591836, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8848318691820266, "mean_inference_ms": 1.9414792035154984, "mean_action_processing_ms": 0.06538900268042061, "mean_env_wait_ms": 942.5144253020471, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 5040, "timesteps_this_iter": 0, "agent_timesteps_total": 5040, "timers": {"load_time_ms": 0.175, "load_throughput": 182957.644, "learn_time_ms": 8.63, "learn_throughput": 3708.174, "update_time_ms": 1.803}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7021677494049072, "mean_q": -63.32890319824219, "min_q": -109.0313720703125, "max_q": -7.632638454437256, "cur_lr": 0.0005}, "td_error": "[ -7.12175     3.260147   -5.308548   15.221104   28.434853  -14.919739\n -12.65844   -17.003319   -4.5797462 -23.900713   14.959648   14.35981\n  35.230995  -19.115833  -25.352995   14.022949  -20.835388  -14.463676\n  30.348885  -36.85599    94.8885      8.939102   -5.1567574  14.644932\n  -0.8454819 -20.603844   28.252785   54.620373   41.48681   375.75842\n -24.268997    2.0026321]", "mean_td_error": 16.35752296447754, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5040, "num_agent_steps_sampled": 5040, "num_steps_trained": 4640, "num_agent_steps_trained": 4640, "last_target_update_ts": 5040, "num_target_updates": 9, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14, "training_iteration": 5, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-44-39", "timestamp": 1720111479, "time_this_iter_s": 163.31652402877808, "time_total_s": 895.093258857727, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x70893911e850>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x70893911e8e0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x70893911eb50>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x70893911e070>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 895.093258857727, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.647210300429185, "ram_util_percent": 9.844206008583692}}
{"episode_reward_max": -5729.0, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -7118.986479591836, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8848318691820266, "mean_inference_ms": 1.9414792035154984, "mean_action_processing_ms": 0.06538900268042061, "mean_env_wait_ms": 942.5144253020471, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 6048, "timesteps_this_iter": 0, "agent_timesteps_total": 6048, "timers": {"load_time_ms": 0.173, "load_throughput": 185000.314, "learn_time_ms": 8.617, "learn_throughput": 3713.786, "update_time_ms": 1.766}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.257802724838257, "mean_q": -70.75776672363281, "min_q": -105.95204162597656, "max_q": -14.571577072143555, "cur_lr": 0.0005}, "td_error": "[ 2.5157795e+01  2.4810398e+01 -2.2491081e+01 -2.3933533e+01\n  3.1273376e+01 -4.3759899e+01  3.8283997e+00  1.5538902e+00\n  1.1216560e+01  1.8142876e+01 -1.9412918e+00 -2.3927082e+01\n  4.8571465e+01 -2.8651848e+01 -1.9130814e+01  1.7218506e+01\n -2.4189449e+01 -1.2795139e+01  1.0179901e-01  2.4002365e+01\n -1.2127670e+01  1.4047714e+01 -3.2356140e+01  1.0438447e+02\n  1.3366615e+01  2.7293831e+01 -8.8821754e+00  1.7430260e+01\n  3.5598907e+01  2.4593290e+01 -1.0948769e+01  3.3055466e+01]", "mean_td_error": 6.578534126281738, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6048, "num_agent_steps_sampled": 6048, "num_steps_trained": 5792, "num_agent_steps_trained": 5792, "last_target_update_ts": 6048, "num_target_updates": 11, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14, "training_iteration": 6, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-47-45", "timestamp": 1720111665, "time_this_iter_s": 185.9368031024933, "time_total_s": 1081.0300619602203, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390b5fd0>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x708939094070>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390940a0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x708939094100>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1081.0300619602203, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.447169811320757, "ram_util_percent": 9.47433962264151}}
{"episode_reward_max": -5088.25, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -6800.925510204082, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875, -6181.5, -5831.375, -6766.25, -6905.75, -6060.625, -5088.25, -6319.875], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8829325327580572, "mean_inference_ms": 1.9423515413502512, "mean_action_processing_ms": 0.0666797986185608, "mean_env_wait_ms": 944.1653502214855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 7056, "timesteps_this_iter": 0, "agent_timesteps_total": 7056, "timers": {"load_time_ms": 0.175, "load_throughput": 183057.458, "learn_time_ms": 8.986, "learn_throughput": 3561.068, "update_time_ms": 1.877}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2509758472442627, "mean_q": -92.34249877929688, "min_q": -133.01417541503906, "max_q": -25.131444931030273, "cur_lr": 0.0005}, "td_error": "[ -2.302597   60.343292  -19.89848    23.919151  -20.864319   70.00299\n  18.893951   38.388573  -34.883274   22.107574    1.730957  -51.609974\n  28.227112   64.662674  -19.260597    9.357239   12.417488   10.468529\n  21.46534   -25.379662   58.825188   15.756836    9.299606  -14.095444\n -10.703304   -6.4456863  56.791504  -11.757332   10.7890625  11.428413\n  38.544617   -7.5590057]", "mean_td_error": 11.208138465881348, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7056, "num_agent_steps_sampled": 7056, "num_steps_trained": 6944, "num_agent_steps_trained": 6944, "last_target_update_ts": 7056, "num_target_updates": 13, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21, "training_iteration": 7, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-50-41", "timestamp": 1720111841, "time_this_iter_s": 175.9310119152069, "time_total_s": 1256.9610738754272, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x708939124250>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089391246d0>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089391240a0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089391240d0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1256.9610738754272, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.268924302788845, "ram_util_percent": 9.517131474103586}}
{"episode_reward_max": -5088.25, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -6800.925510204082, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875, -6181.5, -5831.375, -6766.25, -6905.75, -6060.625, -5088.25, -6319.875], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8829325327580572, "mean_inference_ms": 1.9423515413502512, "mean_action_processing_ms": 0.0666797986185608, "mean_env_wait_ms": 944.1653502214855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 8064, "timesteps_this_iter": 0, "agent_timesteps_total": 8064, "timers": {"load_time_ms": 0.177, "load_throughput": 180424.423, "learn_time_ms": 8.784, "learn_throughput": 3642.925, "update_time_ms": 1.76}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.223043441772461, "mean_q": -104.9881591796875, "min_q": -152.76370239257812, "max_q": -7.276798248291016, "cur_lr": 0.0005}, "td_error": "[-11.110054  -74.20528    20.719086   33.27899     4.346466   29.179443\n -28.533562  -11.872223   -9.510963   21.364616    9.57489   -21.414555\n   5.107727   84.931274   66.52356    82.855675    0.5726776   2.0535126\n -22.280449   14.767319  -24.218506   -9.181633  -37.72995   -21.342659\n   4.134918  -15.176773  -31.304329   19.930962   63.866386   52.06584\n  15.532623   -5.199852 ]", "mean_td_error": 6.491412162780762, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8064, "num_agent_steps_sampled": 8064, "num_steps_trained": 8096, "num_agent_steps_trained": 8096, "last_target_update_ts": 8064, "num_target_updates": 15, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21, "training_iteration": 8, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-54-06", "timestamp": 1720112046, "time_this_iter_s": 205.75795006752014, "time_total_s": 1462.7190239429474, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390b0610>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390b0e50>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390b0e80>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390b0ca0>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1462.7190239429474, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.372448979591837, "ram_util_percent": 9.510204081632654}}
{"episode_reward_max": -3561.0, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -6098.555739795918, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875, -6181.5, -5831.375, -6766.25, -6905.75, -6060.625, -5088.25, -6319.875, -3600.625, -4421.625, -4418.125, -3739.25, -3778.5, -4421.0, -3561.0], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8867716338961346, "mean_inference_ms": 1.945251477237257, "mean_action_processing_ms": 0.06769905533065446, "mean_env_wait_ms": 949.9612433023738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 9072, "timesteps_this_iter": 0, "agent_timesteps_total": 9072, "timers": {"load_time_ms": 0.175, "load_throughput": 182609.154, "learn_time_ms": 8.677, "learn_throughput": 3687.776, "update_time_ms": 1.743}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.253847599029541, "mean_q": -125.2965087890625, "min_q": -190.0137176513672, "max_q": -64.19921875, "cur_lr": 0.0005}, "td_error": "[ 2.8284920e+01 -5.2524803e+01 -3.6102142e+00 -8.8141479e+00\n -3.1619232e+01  4.1807877e+01  3.8966660e+01  4.1767883e-01\n -3.0857391e+01  2.8284920e+01 -2.9732635e+01  7.5927429e+00\n  5.6012825e+01 -3.4393723e+01 -4.7244850e+01 -4.4724426e+00\n -1.8789001e+01 -8.2678146e+00  6.7240295e+00  2.2043457e+00\n -3.5174683e+01  6.5474030e+01  2.0073578e+01 -9.6830643e+01\n -3.1482727e+01 -1.7639236e+01  4.6210968e+01  4.1770648e+02\n  1.5892677e+01  2.5256836e+01  2.8153786e+01  1.0833389e+01]", "mean_td_error": 12.13888168334961, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9072, "num_agent_steps_sampled": 9072, "num_steps_trained": 9248, "num_agent_steps_trained": 9248, "last_target_update_ts": 9072, "num_target_updates": 17, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28, "training_iteration": 9, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_17-57-11", "timestamp": 1720112231, "time_this_iter_s": 184.9556164741516, "time_total_s": 1647.674640417099, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x708939094d90>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x708939094d00>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x708939094cd0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x708939094c10>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1647.674640417099, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.51628787878788, "ram_util_percent": 10.505303030303029}}
{"episode_reward_max": -3561.0, "episode_reward_min": -8421.496428571429, "episode_reward_mean": -6098.555739795918, "episode_len_mean": 301.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8073.424999999999, -7233.70357142857, -8421.496428571429, -7180.638095238095, -6481.315476190475, -6546.22857142857, -6566.003571428571, -7844.25, -5729.0, -7912.375, -6819.375, -8056.5, -6709.625, -6091.875, -6181.5, -5831.375, -6766.25, -6905.75, -6060.625, -5088.25, -6319.875, -3600.625, -4421.625, -4418.125, -3739.25, -3778.5, -4421.0, -3561.0], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8867716338961346, "mean_inference_ms": 1.945251477237257, "mean_action_processing_ms": 0.06769905533065446, "mean_env_wait_ms": 949.9612433023738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 7, "timesteps_total": 10080, "timesteps_this_iter": 0, "agent_timesteps_total": 10080, "timers": {"load_time_ms": 0.175, "load_throughput": 182857.94, "learn_time_ms": 8.792, "learn_throughput": 3639.714, "update_time_ms": 1.836}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.043065071105957, "mean_q": -173.37295532226562, "min_q": -221.04684448242188, "max_q": -93.33793640136719, "cur_lr": 0.0005}, "td_error": "[ -28.289368   -76.19107     -1.7157135   -9.625717    19.38861\n   18.297775    -9.735657  -134.5557    -101.991425   -11.968536\n  -12.057785   -15.2715       4.0219116    9.727661   -97.824356\n    5.965027    -2.9526367  -21.370514    16.50792    -12.158829\n   -2.1303558  -13.966858    -2.4862518  -56.9227       6.1616364\n  -18.735977    28.541183    28.635147    -9.783981     6.225525\n   97.99901     18.00235  ]", "mean_td_error": -11.883161544799805, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10080, "num_agent_steps_sampled": 10080, "num_steps_trained": 10400, "num_agent_steps_trained": 10400, "last_target_update_ts": 10080, "num_target_updates": 19, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 28, "training_iteration": 10, "trial_id": "97ca2_00000", "experiment_id": "70d3010c893040398e015cbc3f6a40f6", "date": "2024-07-04_18-00-08", "timestamp": 1720112408, "time_this_iter_s": 176.7424554824829, "time_total_s": 1824.417095899582, "pid": 1898241, "hostname": "vm-he-a100-01.doc.ic.ac.uk", "node_ip": "146.169.1.59", "config": {"num_workers": 7, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 32, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "markets-daily_investor-v0", "observation_space": null, "action_space": null, "env_config": {"background_config": "flash_crash", "background_config_extra_kvargs": {"num_noise_agents": 15, "num_value_agents": 10, "num_mm_agents": 19, "num_long_momentum_agents": 5, "num_short_momentum_agents": 5, "oracle_params": "<abides_markets.configs.agent_params.GBMOracleConfig object at 0x7089390d4280>", "mm_agent_params": "<abides_markets.configs.agent_params.MarketMakerAgentConfig object at 0x7089390d4760>", "value_agent_params": "<abides_markets.configs.agent_params.ValueAgentConfig object at 0x7089390d4ac0>", "momentum_agent_params": "<abides_markets.configs.agent_params.MomentumAgentConfig object at 0x7089390d4970>"}, "timestep_duration": "1s", "mkt_close": "09:35:00", "first_interval": "00:00:01", "done_ratio": -Infinity, "order_fixed_size": 5000000000, "state_history_length": 8, "reward_lookback": 8}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.MyCustomCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "target_network_update_freq": 500, "buffer_size": 50000, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1824.417095899582, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.80952380952381, "ram_util_percent": 10.709920634920637}}
